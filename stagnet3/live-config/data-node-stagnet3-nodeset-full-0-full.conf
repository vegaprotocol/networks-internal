AutoInitialiseFromDeHistory = false
ChainID = "stagnet3"
GatewayEnabled = true

[API]
  CoreNodeGRPCPort = 3002
  CoreNodeIP = "127.0.0.1"
  IP = "0.0.0.0"
  Level = "Info"
  Port = 3007
  Reflection = false
  StreamRetries = 3
  Timeout = "5s"
  WebUIEnabled = false
  WebUIPort = 3006

[Broker]
  Level = "Info"
  PanicOnError = false
  SocketServerInboundBufferSize = 10000
  SocketServerOutboundBufferSize = 10000
  UseBufferedEventSource = true
  UseEventFile = false
  [Broker.BufferedEventSourceConfig]
    EventsPerFile = 10000000
    MaxBufferedEvents = 100000000
    SendChannelBufferSize = 10000
  [Broker.FileEventSourceConfig]
    File = "vega.evt"
    SendChannelBufferSize = 1000
    TimeBetweenBlocks = "1s"
  [Broker.SocketConfig]
    IP = "0.0.0.0"
    MaxReceiveTimeouts = 3
    Port = 3005
    TransportType = "tcp"

[CandlesV2]
  Level = "Info"
  [CandlesV2.CandleStore]
    DefaultCandleIntervals = ""
  [CandlesV2.CandleUpdates]
    CandleUpdatesStreamBufferSize = 100
    CandleUpdatesStreamInterval = "1s"
    CandleUpdatesStreamSubscriptionMsgBufferSize = 100
    CandlesFetchTimeout = "10s"

[DeHistory]
  AddSnapshotsInterval = "5s"
  AddSnapshotsToStore = true
  Enabled = false
  Level = "Info"
  WipeOnStartup = true
  [DeHistory.Initialise]
    GrpcAPIPorts = []
    MinimumBlockCount = 1
    TimeOut = "1m0s"
    ToSegment = ""
  [DeHistory.Snapshot]
    WaitForCreationLockTimeout = "5m0s"
  [DeHistory.Store]
    BootstrapPeers = []
    HistoryRetentionBlockSpan = 604800
    IDSeed = "7233510c-6842-42ec-aa30-67cb57e56548"
    StartWebUI = false
    SwarmKeyOverride = ""
    SwarmPort = 4001
    UseIpfsDefaultPeers = true
    WebUIPort = 5001

[Gateway]
  GraphQLPlaygroundEnabled = true
  Level = "Info"
  MaxSubscriptionPerClient = 250
  SubscriptionRetries = 3
  Timeout = "5s"
  [Gateway.GraphQL]
    AutoCertDomain = ""
    CertificateFile = ""
    ComplexityLimit = 0
    Enabled = true
    Endpoint = "/graphql"
    HTTPSEnabled = false
    IP = "0.0.0.0"
    KeyFile = ""
    Port = 3008
  [Gateway.Node]
    IP = "0.0.0.0"
    Port = 3007
  [Gateway.REST]
    APMEnabled = true
    Enabled = true
    IP = "0.0.0.0"
    Port = 3009

[Logging]
  Environment = "dev"
  [Logging.Custom]
    [Logging.Custom.Zap]
      Development = true
      Encoding = "console"
      ErrorOutputPaths = ["stderr"]
      Level = -1
      OutputPaths = ["stdout"]
    [Logging.Custom.ZapEncoder]
      CallerKey = "C"
      EncodeCaller = "short"
      EncodeDuration = "string"
      EncodeLevel = "capital"
      EncodeName = "full"
      EncodeTime = "iso8601"
      LevelKey = "L"
      LineEnding = "\n"
      MessageKey = "M"
      NameKey = "N"
      TimeKey = "T"

[Metrics]
  Enabled = true
  Level = "Info"
  Path = "/metrics"
  Port = 2113
  Timeout = "5s"

[Pprof]
  BlockProfileRate = 0
  Enabled = true
  Level = "Info"
  MutexProfileFraction = 0
  Port = 6060
  ProfilesDir = "/local/vega/.data-node"
  WriteEvery = "15m0s"

[SQLStore]
  FanOutBufferSize = 1000
  Level = "Info"
  UseEmbedded = false
  WipeOnStartup = true
  [SQLStore.ConnectionConfig]
    Database = "vega"
    Host = "localhost"
    MaxConnLifetime = "30m0s"
    MaxConnLifetimeJitter = "5m0s"
    Password = "vega"
    Port = 5432
    SocketDir = "/tmp"
    Username = "vega"
  [SQLStore.ConnectionRetryConfig]
    InitialInterval = "1s"
    MaxElapsedTime = "1m0s"
    MaxInterval = "10s"
    MaxRetries = 10
  [SQLStore.LogRotationConfig]
    MaxAge = 2
    MaxSize = 100

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "balances"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "checkpoints"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 year"
    HypertableOrCaggName = "conflated_balances"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "delegations"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "ledger"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "orders"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "trades"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 month"
    HypertableOrCaggName = "trades_candle_1_minute"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 month"
    HypertableOrCaggName = "trades_candle_5_minutes"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 month"
    HypertableOrCaggName = "trades_candle_15_minutes"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 year"
    HypertableOrCaggName = "trades_candle_1_hour"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 year"
    HypertableOrCaggName = "trades_candle_6_hours"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "market_data"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "margin_levels"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 year"
    HypertableOrCaggName = "conflated_margin_levels"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "positions"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "1 year"
    HypertableOrCaggName = "conflated_positions"

  [[SQLStore.RetentionPolicies]]
    DataRetentionPeriod = "7 days"
    HypertableOrCaggName = "liquidity_provisions"

[Service]
  Level = "Info"

[SqlStore]
  Level = "Info"
  UseEmbedded = false
  WipeOnStartup = true
  [SqlStore.ConnectionConfig]
    Database = "vega0"
    Host = "127.0.0.1"
    Password = "ec27af68a52b74665860889db70fe327"
    Port = 5432
    UseTransactions = true
    Username = "vega"
